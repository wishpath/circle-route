problems:
  - if first and last points are in the loop